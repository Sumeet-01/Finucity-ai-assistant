{% extends "base.html" %}

{% block title %}Financial Blog | Finucity{% endblock %}

{% block content %}
<section class="bl-hero">
    <div class="bl-hero__particles" id="blParticles"></div>
    <div class="container">
        <div class="bl-hero__content reveal-up">
            <span class="bl-hero__badge">Knowledge Hub</span>
            <h1 class="bl-hero__title">Financial <span class="gradient-text">Blog</span></h1>
            <p class="bl-hero__subtitle">Expert insights, tax strategies, investment analysis, and financial planning guides â€” curated by CAs and financial experts.</p>
        </div>
    </div>
</section>

<!-- Categories -->
<section class="bl-section">
    <div class="container">
        <div class="bl-filters reveal-up">
            <button class="bl-filter bl-filter--active" onclick="filterBlog('all',this)">All Articles</button>
            <button class="bl-filter" onclick="filterBlog('tax',this)">Tax Planning</button>
            <button class="bl-filter" onclick="filterBlog('invest',this)">Investing</button>
            <button class="bl-filter" onclick="filterBlog('gst',this)">GST</button>
            <button class="bl-filter" onclick="filterBlog('savings',this)">Savings</button>
            <button class="bl-filter" onclick="filterBlog('budget',this)">Budget {{ current_year }}</button>
        </div>

        <!-- Featured -->
        {% if featured %}
        <div class="bl-featured reveal-up">
            <div class="bl-featured__badge">Featured</div>
            <div class="bl-featured__content">
                <span class="bl-featured__tag">{{ featured.category|capitalize }}</span>
                <h2>{{ featured.title }}</h2>
                <p>{{ featured.description }}</p>
                <div class="bl-featured__meta">
                    <span>&#128197; {{ featured.published_at[:10] if featured.published_at|length > 10 else featured.published_at }}</span>
                    <span>&#128214; {{ featured.read_time }} min read</span>
                    <span>&#128100; {{ featured.author }}</span>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Articles Grid (dynamically rendered) -->
        <div class="bl-grid">
            {% for post in posts %}
            {% if not post.is_featured %}
            <article class="bl-card reveal-up" data-category="{{ post.category }}" style="--delay:{{ loop.index * 0.05 }}s">
                <div class="bl-card__accent" style="background:linear-gradient(135deg,{{ post.accent_color|default('#667eea,#764ba2') }})"></div>
                <div class="bl-card__body">
                    <span class="bl-card__tag">{{ post.category|capitalize }}</span>
                    <h3>{{ post.title }}</h3>
                    <p>{{ post.description }}</p>
                    <div class="bl-card__meta">
                        <span>&#128214; {{ post.read_time }} min</span>
                        <span>&#128197; {{ post.published_at[:10] if post.published_at|length > 10 else post.published_at }}</span>
                    </div>
                </div>
            </article>
            {% endif %}
            {% endfor %}
        </div>

        <!-- Newsletter CTA -->
        <div class="bl-newsletter reveal-up">
            <div class="bl-newsletter__glow"></div>
            <h2>Stay Financially Informed</h2>
            <p>Get expert financial insights, tax tips, and market analysis delivered to your inbox every week. No spam, unsubscribe anytime.</p>
            <div class="bl-newsletter__buttons">
                <a href="{{ url_for('main.chat') }}" class="tp-btn tp-btn--primary"><span>Explore with AI</span></a>
                <a href="{{ url_for('main.learning_centre') }}" class="tp-btn tp-btn--secondary"><span>Learning Center</span></a>
            </div>
        </div>
    </div>
</section>

<style>
@keyframes fadeInUp { from { opacity:0; transform:translateY(40px); } to { opacity:1; transform:translateY(0); } }
@keyframes gradient-shift { 0% { background-position:0% 50%; } 50% { background-position:100% 50%; } 100% { background-position:0% 50%; } }
@keyframes particle-float { 0% { transform:translateY(0) translateX(0); opacity:0; } 10% { opacity:1; } 90% { opacity:1; } 100% { transform:translateY(-100vh) translateX(50px); opacity:0; } }

.reveal-up { opacity:0; transform:translateY(50px); transition:all 0.8s cubic-bezier(0.16,1,0.3,1); }
.reveal-up.revealed { opacity:1; transform:translate(0); }

.bl-hero { position:relative; padding:10rem 0 5rem; background:linear-gradient(180deg,var(--bg-main) 0%,rgba(251,160,2,0.03) 50%,var(--bg-main) 100%); overflow:hidden; margin-top:80px; text-align:center; }
.bl-hero__particles { position:absolute; inset:0; pointer-events:none; overflow:hidden; }
.bl-hero__particles .particle { position:absolute; width:3px; height:3px; background:rgba(251,160,2,0.4); border-radius:50%; animation:particle-float linear infinite; }
.bl-hero__content { position:relative; z-index:2; max-width:750px; margin:0 auto; }
.bl-hero__badge { display:inline-block; padding:0.5rem 1.5rem; background:rgba(251,160,2,0.1); border:1px solid rgba(251,160,2,0.3); border-radius:50px; color:var(--accent-primary); font-size:0.85rem; font-weight:600; letter-spacing:1px; text-transform:uppercase; margin-bottom:1.5rem; }
.bl-hero__title { font-size:clamp(2.5rem,5vw,3.8rem); font-weight:900; color:var(--text-light); margin-bottom:1rem; }
.gradient-text { background:linear-gradient(135deg,#fba002,#ff6b35,#fba002); background-size:200% auto; -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; animation:gradient-shift 4s ease infinite; }
.bl-hero__subtitle { color:var(--text-muted); font-size:1.1rem; line-height:1.7; }

.bl-section { padding:4rem 0 6rem; }
.bl-filters { display:flex; gap:0.5rem; justify-content:center; flex-wrap:wrap; margin-bottom:3rem; }
.bl-filter { padding:0.6rem 1.5rem; border-radius:50px; border:1px solid rgba(251,160,2,0.15); background:transparent; color:var(--text-muted); cursor:pointer; font-size:0.88rem; font-weight:600; transition:all 0.3s; }
.bl-filter:hover { border-color:rgba(251,160,2,0.3); color:var(--text-light); }
.bl-filter--active { background:rgba(251,160,2,0.15); border-color:var(--accent-primary); color:var(--accent-primary); }

.bl-featured { background:var(--bg-alt); border-radius:24px; border:1px solid rgba(251,160,2,0.15); padding:3rem; margin-bottom:3rem; position:relative; overflow:hidden; }
.bl-featured__badge { position:absolute; top:1.5rem; right:1.5rem; padding:0.3rem 1rem; background:var(--accent-gradient); color:#000; border-radius:50px; font-size:0.75rem; font-weight:700; text-transform:uppercase; }
.bl-featured__tag { color:var(--accent-primary); font-size:0.8rem; font-weight:700; text-transform:uppercase; letter-spacing:1px; }
.bl-featured h2 { color:var(--text-light); font-size:1.8rem; margin:0.8rem 0 1rem; font-weight:800; }
.bl-featured p { color:var(--text-muted); line-height:1.8; font-size:1rem; margin-bottom:1.5rem; max-width:700px; }
.bl-featured__meta { display:flex; gap:1.5rem; flex-wrap:wrap; color:var(--text-muted); font-size:0.85rem; }

.bl-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:1.5rem; margin-bottom:4rem; }
.bl-card { background:var(--bg-alt); border-radius:20px; overflow:hidden; border:1px solid rgba(251,160,2,0.06); transition:all 0.4s ease; transition-delay:var(--delay,0s); cursor:pointer; }
.bl-card:hover { border-color:rgba(251,160,2,0.2); transform:translateY(-6px); box-shadow:0 15px 50px rgba(0,0,0,0.2); }
.bl-card__accent { height:4px; }
.bl-card__body { padding:2rem; }
.bl-card__tag { color:var(--accent-primary); font-size:0.75rem; font-weight:700; text-transform:uppercase; letter-spacing:1px; }
.bl-card h3 { color:var(--text-light); font-size:1.1rem; margin:0.8rem 0; font-weight:700; line-height:1.4; }
.bl-card p { color:var(--text-muted); font-size:0.88rem; line-height:1.6; margin-bottom:1rem; }
.bl-card__meta { display:flex; gap:1rem; color:var(--text-muted); font-size:0.8rem; }
.bl-card--hidden { display:none; }

.bl-newsletter { position:relative; text-align:center; padding:4rem 3rem; background:var(--bg-alt); border-radius:24px; border:1px solid rgba(251,160,2,0.15); overflow:hidden; }
.bl-newsletter__glow { position:absolute; top:-50%; left:50%; transform:translateX(-50%); width:400px; height:400px; border-radius:50%; background:radial-gradient(circle,rgba(251,160,2,0.08) 0%,transparent 70%); pointer-events:none; }
.bl-newsletter h2 { font-size:2rem; color:var(--text-light); margin-bottom:1rem; position:relative; }
.bl-newsletter p { color:var(--text-muted); max-width:550px; margin:0 auto 2rem; line-height:1.7; position:relative; }
.bl-newsletter__buttons { display:flex; gap:1rem; justify-content:center; flex-wrap:wrap; position:relative; }
.tp-btn { display:inline-flex; align-items:center; gap:0.5rem; padding:0.9rem 2rem; border-radius:12px; font-weight:700; text-decoration:none; transition:all 0.3s; font-size:0.95rem; }
.tp-btn--primary { background:var(--accent-gradient); color:#000; box-shadow:0 4px 15px rgba(251,160,2,0.3); }
.tp-btn--primary:hover { transform:translateY(-3px); box-shadow:0 8px 25px rgba(251,160,2,0.4); }
.tp-btn--secondary { background:rgba(255,255,255,0.08); color:var(--text-light); border:1px solid rgba(255,255,255,0.1); }
.tp-btn--secondary:hover { background:rgba(255,255,255,0.12); transform:translateY(-2px); }

@media (max-width:768px) { .bl-hero { padding:7rem 1rem 3rem; } .bl-grid { grid-template-columns:1fr; } .bl-featured { padding:2rem; } .bl-featured h2 { font-size:1.4rem; } }
</style>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => { if (entry.isIntersecting) { const d=getComputedStyle(entry.target).getPropertyValue('--delay')||'0s'; setTimeout(()=>entry.target.classList.add('revealed'),parseFloat(d)*1000); observer.unobserve(entry.target); } });
    }, { threshold:0.1, rootMargin:'0px 0px -50px 0px' });
    document.querySelectorAll('.reveal-up').forEach(el=>observer.observe(el));
    const c=document.getElementById('blParticles');
    if(c){for(let i=0;i<15;i++){const p=document.createElement('div');p.className='particle';p.style.left=Math.random()*100+'%';p.style.top=(80+Math.random()*20)+'%';p.style.animationDuration=(8+Math.random()*15)+'s';p.style.animationDelay=Math.random()*10+'s';c.appendChild(p);}}
});

function filterBlog(cat,btn){
    document.querySelectorAll('.bl-filter').forEach(t=>t.classList.remove('bl-filter--active'));
    btn.classList.add('bl-filter--active');
    document.querySelectorAll('.bl-card').forEach(card=>{
        if(cat==='all'||card.dataset.category===cat){card.classList.remove('bl-card--hidden');}
        else{card.classList.add('bl-card--hidden');}
    });
}
</script>
{% endblock %}
