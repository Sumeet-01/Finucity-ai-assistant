{% extends "base.html" %}

{% block title %}SIP Calculator - Finucity{% endblock %}

{% block content %}
<div class="sip-calculator bg-gray-50 min-h-screen py-12">
    <div class="container mx-auto px-4 max-w-6xl">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-2">SIP Calculator</h1>
            <p class="text-gray-600">Plan your Systematic Investment Plan returns</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Input Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6">Investment Details</h2>
                
                <form id="sipCalculatorForm">
                    <div class="mb-6">
                        <label class="block text-sm font-semibold mb-2">Monthly SIP Amount (‚Çπ)</label>
                        <input type="range" id="sipAmountSlider" min="500" max="100000" step="500" value="10000" class="w-full">
                        <div class="flex justify-between mt-2">
                            <span class="text-sm text-gray-500">‚Çπ500</span>
                            <input type="number" id="sipAmount" class="w-32 px-3 py-1 border rounded text-center font-bold" value="10000">
                            <span class="text-sm text-gray-500">‚Çπ1L</span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold mb-2">Expected Return Rate (% p.a.)</label>
                        <input type="range" id="returnRateSlider" min="1" max="30" step="0.5" value="12" class="w-full">
                        <div class="flex justify-between mt-2">
                            <span class="text-sm text-gray-500">1%</span>
                            <input type="number" id="returnRate" class="w-24 px-3 py-1 border rounded text-center font-bold" value="12" step="0.5">
                            <span class="text-sm text-gray-500">30%</span>
                        </div>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-semibold mb-2">Investment Period (Years)</label>
                        <input type="range" id="periodSlider" min="1" max="40" step="1" value="10" class="w-full">
                        <div class="flex justify-between mt-2">
                            <span class="text-sm text-gray-500">1 yr</span>
                            <input type="number" id="period" class="w-24 px-3 py-1 border rounded text-center font-bold" value="10">
                            <span class="text-sm text-gray-500">40 yrs</span>
                        </div>
                    </div>

                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                        Calculate Returns
                    </button>
                </form>
            </div>

            <!-- Results Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6">Expected Returns</h2>
                
                <div id="results">
                    <div class="bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-6 rounded-lg mb-6">
                        <p class="text-sm opacity-80 mb-1">Total Value</p>
                        <p class="text-4xl font-bold" id="totalValue">‚Çπ0</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="bg-green-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600">Invested Amount</p>
                            <p class="text-xl font-bold text-green-700" id="investedAmount">‚Çπ0</p>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <p class="text-sm text-gray-600">Wealth Gained</p>
                            <p class="text-xl font-bold text-blue-700" id="wealthGained">‚Çπ0</p>
                        </div>
                    </div>

                    <!-- Visual Breakdown -->
                    <div class="mb-6">
                        <p class="text-sm font-semibold mb-2">Investment vs Returns</p>
                        <div class="h-4 bg-gray-200 rounded-full overflow-hidden flex">
                            <div id="investedBar" class="bg-green-500 transition-all duration-500" style="width: 50%"></div>
                            <div id="returnsBar" class="bg-blue-500 transition-all duration-500" style="width: 50%"></div>
                        </div>
                        <div class="flex justify-between text-xs mt-1">
                            <span class="text-green-600">‚óè Invested</span>
                            <span class="text-blue-600">‚óè Returns</span>
                        </div>
                    </div>

                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between border-b pb-2">
                            <span class="text-gray-600">Monthly SIP</span>
                            <span class="font-medium" id="displaySIP">‚Çπ10,000</span>
                        </div>
                        <div class="flex justify-between border-b pb-2">
                            <span class="text-gray-600">Duration</span>
                            <span class="font-medium" id="displayDuration">10 years</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Expected Rate</span>
                            <span class="font-medium" id="displayRate">12% p.a.</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Info Section -->
        <div class="mt-8 bg-blue-50 border-2 border-blue-200 rounded-lg p-6">
            <h3 class="font-bold mb-3">üí° SIP Benefits</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="text-center">
                    <div class="text-3xl mb-2">üìä</div>
                    <h4 class="font-semibold">Rupee Cost Averaging</h4>
                    <p class="text-sm text-gray-600">Buy more when prices are low</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üéØ</div>
                    <h4 class="font-semibold">Disciplined Investing</h4>
                    <p class="text-sm text-gray-600">Regular investment habit</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üìà</div>
                    <h4 class="font-semibold">Power of Compounding</h4>
                    <p class="text-sm text-gray-600">Wealth grows exponentially</p>
                </div>
            </div>
        </div>

        <div class="mt-6 text-center">
            <a href="{{ url_for('calculators.calculator_home') }}" class="text-blue-600 hover:underline">‚Üê Back to All Calculators</a>
        </div>
    </div>
</div>

<script>
function calculateSIP() {
    const P = parseFloat(document.getElementById('sipAmount').value) || 0;
    const r = (parseFloat(document.getElementById('returnRate').value) || 0) / 100 / 12;
    const n = (parseFloat(document.getElementById('period').value) || 0) * 12;
    
    if (P <= 0 || n <= 0) return;
    
    // SIP Future Value formula: P √ó ((1 + r)^n - 1) / r √ó (1 + r)
    const futureValue = r > 0 ? P * ((Math.pow(1 + r, n) - 1) / r) * (1 + r) : P * n;
    const investedAmount = P * n;
    const wealthGained = futureValue - investedAmount;
    
    // Update display
    document.getElementById('totalValue').textContent = '‚Çπ' + Math.round(futureValue).toLocaleString('en-IN');
    document.getElementById('investedAmount').textContent = '‚Çπ' + Math.round(investedAmount).toLocaleString('en-IN');
    document.getElementById('wealthGained').textContent = '‚Çπ' + Math.round(wealthGained).toLocaleString('en-IN');
    
    // Update bar chart
    const investedPct = (investedAmount / futureValue) * 100;
    document.getElementById('investedBar').style.width = investedPct + '%';
    document.getElementById('returnsBar').style.width = (100 - investedPct) + '%';
    
    // Update summary
    document.getElementById('displaySIP').textContent = '‚Çπ' + P.toLocaleString('en-IN');
    document.getElementById('displayDuration').textContent = document.getElementById('period').value + ' years';
    document.getElementById('displayRate').textContent = document.getElementById('returnRate').value + '% p.a.';
}

// Sync sliders with inputs
['sipAmount', 'returnRate', 'period'].forEach(id => {
    const slider = document.getElementById(id + 'Slider');
    const input = document.getElementById(id);
    
    slider.addEventListener('input', () => {
        input.value = slider.value;
        calculateSIP();
    });
    
    input.addEventListener('input', () => {
        slider.value = input.value;
        calculateSIP();
    });
});

document.getElementById('sipCalculatorForm').addEventListener('submit', e => {
    e.preventDefault();
    calculateSIP();
});

// Initial calculation
calculateSIP();
</script>
{% endblock %}
