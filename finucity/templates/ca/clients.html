<! DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Requests | CA Workspace | Finucity</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic. com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/ca-dashboard.css') }}">
</head>
<body>
    {% include 'ca/partials/sidebar.html' %}

    <main class="main-content">
        {% include 'ca/partials/header.html' %}

        <div class="page-content">
            <div class="page-title">
                <h1>Client Requests</h1>
                <p>Manage incoming client requests and consultations</p>
            </div>

            <!-- Filters & Stats -->
            <div class="filters-bar">
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">
                        All <span class="count">12</span>
                    </button>
                    <button class="filter-tab" data-filter="new">
                        New <span class="count">3</span>
                    </button>
                    <button class="filter-tab" data-filter="pending">
                        Pending <span class="count">4</span>
                    </button>
                    <button class="filter-tab" data-filter="active">
                        Active <span class="count">5</span>
                    </button>
                    <button class="filter-tab" data-filter="completed">
                        Completed <span class="count">127</span>
                    </button>
                </div>
                <div class="filter-actions">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search clients... ">
                    </div>
                    <select class="filter-select">
                        <option>All Services</option>
                        <option>Tax Planning</option>
                        <option>GST Filing</option>
                        <option>ITR Filing</option>
                        <option>Audit</option>
                    </select>
                </div>
            </div>

            <!-- Requests List -->
            <div class="requests-list">
                <!-- New Request -->
                <div class="request-card new">
                    <div class="request-status-bar"></div>
                    <div class="request-header">
                        <div class="request-user">
                            <div class="user-avatar">RS</div>
                            <div class="user-info">
                                <h4>Rahul Sharma</h4>
                                <span class="user-location"><i class="fas fa-map-marker-alt"></i> Delhi, NCR</span>
                            </div>
                        </div>
                        <div class="request-badges">
                            <span class="badge new">New</span>
                            <span class="badge urgent">Urgent</span>
                        </div>
                    </div>
                    <div class="request-body">
                        <div class="request-service">
                            <i class="fas fa-file-invoice"></i>
                            <span>GST Compliance</span>
                        </div>
                        <p class="request-description">Need help with GST filing for my e-commerce business.  Multiple state registrations required.  Monthly compliance support needed for ongoing operations.</p>
                        <div class="request-meta">
                            <span><i class="fas fa-rupee-sign"></i> ₹15,000 - ₹25,000</span>
                            <span><i class="fas fa-clock"></i> 2 hours ago</span>
                            <span><i class="fas fa-calendar"></i> Ongoing support</span>
                        </div>
                    </div>
                    <div class="request-actions">
                        <button class="btn-accept" onclick="acceptRequest('1')">
                            <i class="fas fa-check"></i> Accept
                        </button>
                        <button class="btn-decline" onclick="declineRequest('1')">
                            <i class="fas fa-times"></i> Decline
                        </button>
                        <button class="btn-chat" onclick="openChat('1')">
                            <i class="fas fa-comment"></i> Chat
                        </button>
                        <button class="btn-more">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>

                <!-- New Request -->
                <div class="request-card new">
                    <div class="request-status-bar"></div>
                    <div class="request-header">
                        <div class="request-user">
                            <div class="user-avatar">PM</div>
                            <div class="user-info">
                                <h4>Priya Mehta</h4>
                                <span class="user-location"><i class="fas fa-map-marker-alt"></i> Bangalore, Karnataka</span>
                            </div>
                        </div>
                        <div class="request-badges">
                            <span class="badge new">New</span>
                        </div>
                    </div>
                    <div class="request-body">
                        <div class="request-service">
                            <i class="fas fa-calculator"></i>
                            <span>Tax Planning</span>
                        </div>
                        <p class="request-description">Looking for tax planning consultation for FY 2024-25.  Salaried professional with rental income and stock investments. Need to optimize tax liability.</p>
                        <div class="request-meta">
                            <span><i class="fas fa-rupee-sign"></i> ₹5,000 - ₹10,000</span>
                            <span><i class="fas fa-clock"></i> 5 hours ago</span>
                            <span><i class="fas fa-calendar"></i> One-time</span>
                        </div>
                    </div>
                    <div class="request-actions">
                        <button class="btn-accept" onclick="acceptRequest('2')">
                            <i class="fas fa-check"></i> Accept
                        </button>
                        <button class="btn-decline" onclick="declineRequest('2')">
                            <i class="fas fa-times"></i> Decline
                        </button>
                        <button class="btn-chat" onclick="openChat('2')">
                            <i class="fas fa-comment"></i> Chat
                        </button>
                        <button class="btn-more">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>

                <!-- Pending Request -->
                <div class="request-card pending">
                    <div class="request-status-bar"></div>
                    <div class="request-header">
                        <div class="request-user">
                            <div class="user-avatar">AK</div>
                            <div class="user-info">
                                <h4>Amit Kumar</h4>
                                <span class="user-location"><i class="fas fa-map-marker-alt"></i> Pune, Maharashtra</span>
                            </div>
                        </div>
                        <div class="request-badges">
                            <span class="badge pending">Pending Response</span>
                        </div>
                    </div>
                    <div class="request-body">
                        <div class="request-service">
                            <i class="fas fa-file-alt"></i>
                            <span>ITR Filing</span>
                        </div>
                        <p class="request-description">Need to file ITR for previous 2 years.  Have salary income, capital gains from mutual funds, and some freelance income. Documents are ready.</p>
                        <div class="request-meta">
                            <span><i class="fas fa-rupee-sign"></i> ₹3,000 - ₹5,000</span>
                            <span><i class="fas fa-clock"></i> 1 day ago</span>
                            <span><i class="fas fa-hourglass-half"></i> Awaiting your response</span>
                        </div>
                    </div>
                    <div class="request-actions">
                        <button class="btn-primary" onclick="sendQuote('3')">
                            <i class="fas fa-paper-plane"></i> Send Quote
                        </button>
                        <button class="btn-chat" onclick="openChat('3')">
                            <i class="fas fa-comment"></i> Chat
                        </button>
                        <button class="btn-more">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>

                <!-- Active Client -->
                <div class="request-card active">
                    <div class="request-status-bar"></div>
                    <div class="request-header">
                        <div class="request-user">
                            <div class="user-avatar">SG</div>
                            <div class="user-info">
                                <h4>Suresh Gupta</h4>
                                <span class="user-location"><i class="fas fa-map-marker-alt"></i> Mumbai, Maharashtra</span>
                            </div>
                        </div>
                        <div class="request-badges">
                            <span class="badge active">Active</span>
                            <span class="badge progress">In Progress</span>
                        </div>
                    </div>
                    <div class="request-body">
                        <div class="request-service">
                            <i class="fas fa-search-dollar"></i>
                            <span>Audit Services</span>
                        </div>
                        <p class="request-description">Annual statutory audit for private limited company. Turnover:  ₹5 Cr.  Need audit report and compliance certificates.</p>
                        <div class="request-meta">
                            <span><i class="fas fa-rupee-sign"></i> ₹75,000 (Agreed)</span>
                            <span><i class="fas fa-clock"></i> Started 5 days ago</span>
                            <span><i class="fas fa-tasks"></i> 60% Complete</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 60%"></div>
                        </div>
                    </div>
                    <div class="request-actions">
                        <button class="btn-primary" onclick="viewDetails('4')">
                            <i class="fas fa-folder-open"></i> View Details
                        </button>
                        <button class="btn-chat" onclick="openChat('4')">
                            <i class="fas fa-comment"></i> Chat
                        </button>
                        <button class="btn-more">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <button class="mobile-toggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Accept Modal -->
    <div class="modal" id="acceptModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Accept Request</h3>
                <button class="modal-close" onclick="closeModal('acceptModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p>You are about to accept this client request.  Please provide your quote and expected timeline.</p>
                <div class="form-group">
                    <label>Your Quote (₹)</label>
                    <input type="number" class="form-input" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label>Expected Timeline</label>
                    <select class="form-input">
                        <option>Within 1 week</option>
                        <option>1-2 weeks</option>
                        <option>2-4 weeks</option>
                        <option>1-2 months</option>
                        <option>Ongoing support</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Message to Client</label>
                    <textarea class="form-input" rows="3" placeholder="Introduce yourself and your approach... "></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="closeModal('acceptModal')">Cancel</button>
                <button class="btn-primary" onclick="confirmAccept()">Send & Accept</button>
            </div>
        </div>
    </div>

    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
        }

        // Filter tabs
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                filterRequests(this.dataset.filter);
            });
        });

        function filterRequests(filter) {
            const cards = document.querySelectorAll('.request-card');
            cards.forEach(card => {
                if (filter === 'all' || card. classList.contains(filter)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        function acceptRequest(id) {
            document.getElementById('acceptModal').classList.add('open');
        }

        function declineRequest(id) {
            if (confirm('Are you sure you want to decline this request?')) {
                showToast('Request declined', 'info');
            }
        }

        function openChat(id) {
            window.location.href = '/ca/messages? client=' + id;
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('open');
        }

        function confirmAccept() {
            closeModal('acceptModal');
            showToast('Request accepted successfully! ', 'success');
        }

        function showToast(message, type) {
            const toast = document. createElement('div');
            toast.className = 'toast ' + type;
            toast.innerHTML = '<i class="fas fa-' + (type === 'success' ?  'check-circle' : 'info-circle') + '"></i>' + message;
            document. body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
    </script>
</body>
</html>